import{t as b,a as m,b as xe}from"../chunks/Ba07GB51.js";import{B as ie,i as J,l as a,n as N,A as c,z as g,u as L,g as ye,y as Q,D as p,x as v,H as Y,G as i,I as $,C as ve}from"../chunks/DcSgunAn.js";import{d as ce,s as I}from"../chunks/BK38orX7.js";import{e as le,i as ne,s as Oe}from"../chunks/Dxk-5unR.js";import{b as Xe,p as ee,a as R,s as $e,c as Ie}from"../chunks/D_PpuvHk.js";import{r as pe}from"../chunks/DUR6UqLw.js";import{a as Te,b as Me}from"../chunks/Dmh89Whc.js";import{b as Re}from"../chunks/B7C0I3Mn.js";import{r as ze,g as _,f as Ae,d as Ce,e as Ee,w as Ge,a as Ne}from"../chunks/Bk3tDF3f.js";import{p as je}from"../chunks/xJOvmrBY.js";import{s as K,t as F}from"../chunks/Cho7X1U_.js";import{T as Pe}from"../chunks/BXAdBgQj.js";var Se=(h,u)=>u("X"),Ue=(h,u)=>u("O"),qe=(h,u)=>u("eraser"),Be=b('<div role="button" tabindex="0"></div>'),Ve=b('<div class="row svelte-w584ne"></div>'),We=b('<p class="svelte-w584ne"> </p>'),Ze=b('<p class="svelte-w584ne"> </p>'),De=b('<h2 class="status warn svelte-w584ne">Taková hra nemůže nastat!</h2>'),He=b('<h2 class="status svelte-w584ne"><span> </span> na tahu</h2>'),Ke=b('<div class="toolbar svelte-w584ne"><button aria-label="X tool" class="player X svelte-w584ne">X</button> <button aria-label="O tool" class="player O svelte-w584ne">O</button> <button aria-label="eraser tool" class="player eraser svelte-w584ne">E</button> <label class="svelte-w584ne"><input type="checkbox">Přepínat se střídáním tahů (kromě gumy)</label></div> <div class="gridContainer svelte-w584ne"><div></div> <div class="boardStatusInfo svelte-w584ne"><div class="placedSymbolsInfo svelte-w584ne"><span class="svelte-w584ne">Umístěno:</span> <span class="svelte-w584ne"><span class="player X svelte-w584ne">X</span> </span> <span class="svelte-w584ne"><span class="player O svelte-w584ne">O</span> </span></div> <!></div></div> <div class="center"><!></div>',1);function Fe(h,u){ie(u,!0);let f=Xe(u,"boardApiInfo",7),z=N(()=>f().name);J(()=>{document.title="Editor - "+a(z)});function T(e,s){let o=0;for(let y of e)for(let D of y)s==D&&o++;return o}let r=g("X"),M=g("cursor-X"),O="",d=g("X"),j=g(!1),A=g(""),P=g(!1),n=ee({O:0,X:0,"":0,eraser:0}),S=N(()=>n.X+n.O),t=N(()=>n.X!=n.O&&n.X!=n.O+1?n.X>n.O?{ok:!1,message:"Moc křížků!"}:{ok:!1,message:"Moc koleček!"}:{ok:!0,message:"V pořádku"}),l=g(!1);J(()=>{a(S)%2==0?c(d,"X"):c(d,"O"),a(l)&&L(()=>{a(r)!=""&&(console.log("automatická změna toolu na "+a(r)),X(a(d)))})});let w=N(()=>f().uuid);ye(()=>{console.log("reset",a(w)),L(()=>{O="",c(d,"X"),c(j,!1),c(A,""),c(P,!1),k()})});function k(){console.log("co bylo v effectu  z editoru runuje");let e=T(f().board,"X"),s=T(f().board,"O"),o=e+s;n.X=e,n.O=s,o%2==0?(O="O",c(d,"X")):(O="X",c(d,"O"))}function C(e,s){let o=f().board[e][s];o==""?console.log("empty",a(r)):console.log(o,a(r)),o==a(r)||(n[o]-=1,n[a(r)]+=1),f().board[e][s]=a(r),console.log("placeItem",a(r))}function X(e){e=="eraser"?c(r,""):c(r,ee(e)),c(M,"cursor-"+e)}var E=Ke(),x=Q(E),U=p(x);U.__click=[Se,X];var q=v(U,2);q.__click=[Ue,X];var B=v(q,2);B.__click=[qe,X];var ae=v(B,2),se=p(ae);pe(se),Y(),i(ae),i(x);var V=v(x,2),G=p(V);le(G,21,()=>f().board,ne,(e,s,o)=>{var y=Ve();le(y,21,()=>a(s),ne,(D,he,ke)=>{var H=Be();H.__click=()=>C(o,ke),$(()=>K(H,`field ${a(he)??""} svelte-w584ne`)),m(D,H)}),i(y),m(e,y)}),i(G);var te=v(G,2),W=p(te),Z=v(p(W),2),ue=v(p(Z));i(Z);var oe=v(Z,2),fe=v(p(oe));i(oe),i(W);var de=v(W,2);{var _e=e=>{var s=We(),o=p(s);i(s),$(()=>I(o,`✅ ${a(t).message??""}`)),m(e,s)},me=e=>{var s=Ze(),o=p(s);i(s),$(()=>I(o,`❌ ${a(t).message??""}`)),m(e,s)};R(de,e=>{a(t).ok?e(_e):e(me,!1)})}i(te),i(V);var re=v(V,2),be=p(re);{var ge=e=>{var s=De();m(e,s)},we=e=>{var s=He(),o=p(s),y=p(o,!0);i(o),Y(),i(s),$(()=>{K(o,`player ${a(d)??""} svelte-w584ne`),I(y,a(d))}),m(e,s)};R(be,e=>{a(t).ok?e(we,!1):e(ge)})}i(re),$(()=>{F(U,"selected",a(r)==="X"),F(q,"selected",a(r)==="O"),F(B,"selected",a(r)===""),K(G,`grid ${a(M)??""} svelte-w584ne`),I(ue,`: ${n.X??""}`),I(fe,`: ${n.O??""}`)}),Te(se,()=>a(l),e=>c(l,e)),m(h,E),ve()}ce(["click"]);async function Je(h,u,f){(await Ee(u().params.uuid)).ok&&(c(f,!0),await Ge(2e3),c(f,!1))}var Le=b('<div class="toolbar svelte-3txnw5"><input type="text" class="svelte-3txnw5"> <select class="svelte-3txnw5"><option class="o svelte-3txnw5">začátečník</option><option class="o svelte-3txnw5">jednoduchá</option><option class="o svelte-3txnw5">pokročilá</option><option class="o svelte-3txnw5">těžká</option><option class="o svelte-3txnw5">nejtěžší</option></select> <button>Uložit</button></div> <!>',1),Qe=b('<h2 class="errorMessage center svelte-3txnw5"> </h2>'),Ye=b("<!> <!> <!>",1);function ua(h,u){ie(u,!0);const[f,z]=$e(),T=()=>Ie(je,"$page",f);let r=g("");J(()=>{const t=T().params.uuid;console.log("slug changed to",t),t?L(()=>{console.log("gameInfo is",Oe(_)),!("apiResponse"in _&&_.apiResponse.uuid==t)&&Ae(t).then(l=>{console.log("data from editor fetch",l),_.apiResponse=l,_.selected=!0}).catch(l=>{c(r,ee(l))})}):ze()});let M=g(!1);var O=Ye(),d=Q(O);{var j=t=>{var l=Le(),w=Q(l),k=p(w);pe(k);var C=v(k,2),X=v(C,2);X.__click=[Je,T,M],i(w);var E=v(w,2);Fe(E,{get boardApiInfo(){return _.apiResponse}}),Me(k,()=>_.apiResponse.name,x=>_.apiResponse.name=x),Re(C,()=>Ce[_.apiResponse.difficulty],x=>_.apiResponse.difficulty=Ne[x]),m(t,l)};R(d,t=>{_.selected&&t(j)})}var A=v(d,2);{var P=t=>{var l=Qe(),w=p(l,!0);i(l),$(()=>I(w,a(r))),m(t,l)};R(A,t=>{a(r)&&t(P)})}var n=v(A,2);{var S=t=>{Pe(t,{children:(l,w)=>{Y();var k=xe("Změny uloženy");m(l,k)},$$slots:{default:!0}})};R(n,t=>{a(M)&&t(S)})}m(h,O),ve(),z()}ce(["click"]);export{ua as component};
